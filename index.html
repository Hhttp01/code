<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ProCode IDE - סביבת פיתוח מלאה</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    
    <style>
        /* עיצוב גלילה */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; height: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0d1117; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #30363d; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #484f58; }
        
        .ltr { direction: ltr; text-align: left; }
        
        body { 
            margin: 0; padding: 0; overflow: hidden; 
            background-color: #0d1117; color: #c9d1d9;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        }

        /* עורך קוד - שכבות */
        .editor-container { position: relative; height: 100%; width: 100%; background: #0d1117; }
        
        .code-editor, .code-highlight {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            padding: 20px; margin: 0; border: none; font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px; line-height: 1.5; tab-size: 4; box-sizing: border-box;
            overflow: auto; white-space: pre;
        }

        .code-editor {
            background: transparent; color: transparent; caret-color: #58a6ff;
            resize: none; outline: none; z-index: 2;
        }

        .code-highlight { z-index: 1; pointer-events: none; }
        
        pre[class*="language-"] { margin: 0 !important; background: transparent !important; padding: 0 !important; }
        
        .sidebar-transition { transition: transform 0.3s ease; }

        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .animate-slideUp { animation: slideUp 0.3s ease-out; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const STORAGE_KEY = 'pro_code_ide_v2';

        // רכיב אייקונים
        const Icon = ({ name, size = 18, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (iconRef.current && window.lucide) {
                    iconRef.current.innerHTML = '';
                    const iconData = lucide[name] || lucide.File;
                    const svg = lucide.createIconsNode({ name, ...iconData });
                    if (svg) iconRef.current.appendChild(svg);
                }
            }, [name]);
            return <i ref={iconRef} className={`inline-flex items-center justify-center ${className}`} style={{ width: size, height: size }}></i>;
        };

        const App = () => {
            const [files, setFiles] = useState(() => {
                const saved = localStorage.getItem(STORAGE_KEY);
                return saved ? JSON.parse(saved) : {
                    'index.html': '<!DOCTYPE html>\n<html>\n<body>\n  <h1>שלום עולם!</h1>\n</body>\n</html>',
                    'style.css': 'body { background: #0d1117; color: white; }',
                    'script.js': 'console.log("ProCode IDE Ready");'
                };
            });

            const [activeFile, setActiveFile] = useState(Object.keys(files)[0]);
            const [isSidebarOpen, setSidebarOpen] = useState(true);
            const [notification, setNotification] = useState(null);
            
            const editorRef = useRef(null);
            const highlightRef = useRef(null);

            // שמירה ל-LocalStorage
            useEffect(() => {
                localStorage.setItem(STORAGE_
